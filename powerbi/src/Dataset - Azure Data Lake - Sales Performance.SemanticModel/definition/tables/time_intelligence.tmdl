/// Table time_intelligence.
table time_intelligence
	lineageTag: 5d72a475-096f-4745-a732-db72d32eeafe

	calculationGroup
		precedence: 10

		calculationItem ALL = ```
				   CALCULATE (
				        SELECTEDMEASURE (),
				        cal_end_dates[Date] >= Date(1900,1,1) && cal_end_dates[Date] <= Date(2100,1,1)  
				    )
				
				```

		calculationItem CURRENT = CALCULATE(SELECTEDMEASURE())

		calculationItem MTD = ```
				   
				   
				
				-- get the dates
				var curr_date = CALCULATE(MAX(cal_end_dates[Date])) // get the mgmt current end date
				var end_date = curr_date
				var end_date_sply = date(Year(end_date) -1,Month(end_date),day(end_date)) // get the yoy end date
				var start_year = Year(curr_date) 
				var start_qtr_month = (Quarter(curr_date) * 3) - 2  
				var start_month = Month(curr_date)
				var start_date_ytd = date(start_year,1,1)  
				var start_date_ytd_sply = date(start_year-1,1,1)  
				var start_date_qtd = date(start_year,start_qtr_month ,1)  
				var start_date_qtd_sply = date(start_year -1,start_qtr_month,1)  
				var start_date_mtd = date(start_year,start_month,1)  
				var start_date_mtd_sply = date(start_year -1,start_month,1)  
				
				// do the calc   
				var res =   CALCULATE (SELECTEDMEASURE (),cal_end_dates[Date] >= start_date_mtd && cal_end_dates[Date] <= end_date )
				
				return res
				
				
				
				```

		calculationItem MTD_SPLY = ```
				   
				   
				
				-- get the dates
				var curr_date = CALCULATE(MAX(cal_end_dates[Date])) // get the mgmt current end date
				var end_date = curr_date
				var end_date_sply = date(Year(end_date) -1,Month(end_date),day(end_date)) // get the yoy end date
				var start_year = Year(curr_date) 
				var start_qtr_month = (Quarter(curr_date) * 3) - 2  
				var start_month = Month(curr_date)
				var start_date_ytd = date(start_year,1,1)  
				var start_date_ytd_sply = date(start_year-1,1,1)  
				var start_date_qtd = date(start_year,start_qtr_month ,1)  
				var start_date_qtd_sply = date(start_year -1,start_qtr_month,1)  
				var start_date_mtd = date(start_year,start_month,1)  
				var start_date_mtd_sply = date(start_year -1,start_month,1)  
				
				// do the calc   
				var res =   CALCULATE (SELECTEDMEASURE (),cal_end_dates[Date] >= start_date_mtd_sply && cal_end_dates[Date] <= end_date_sply )
				
				return res
				
				
				
				```

		calculationItem QTD = ```
				   
				   
				
				-- get the dates
				var curr_date = CALCULATE(MAX(cal_end_dates[Date])) // get the mgmt current end date
				var end_date = curr_date
				var end_date_sply = date(Year(end_date) -1,Month(end_date),day(end_date)) // get the yoy end date
				var start_year = Year(curr_date) 
				var start_qtr_month = (Quarter(curr_date) * 3) - 2  
				var start_month = Month(curr_date)
				var start_date_ytd = date(start_year,1,1)  
				var start_date_ytd_sply = date(start_year-1,1,1)  
				var start_date_qtd = date(start_year,start_qtr_month ,1)  
				var start_date_qtd_sply = date(start_year -1,start_qtr_month,1)  
				var start_date_mtd = date(start_year,start_month,1)  
				var start_date_mtd_sply = date(start_year -1,start_month,1)  
				
				// do the calc   
				var res =   CALCULATE (SELECTEDMEASURE (),cal_end_dates[Date] >= start_date_qtd && cal_end_dates[Date] <= end_date )
				
				return res
				
				
				
				```

		calculationItem QTD_SPLY = ```
				   
				   
				
				-- get the dates
				var curr_date = CALCULATE(MAX(cal_end_dates[Date])) // get the mgmt current end date
				var end_date = curr_date
				var end_date_sply = date(Year(end_date) -1,Month(end_date),day(end_date)) // get the yoy end date
				var start_year = Year(curr_date) 
				var start_qtr_month = (Quarter(curr_date) * 3) - 2  
				var start_month = Month(curr_date)
				var start_date_ytd = date(start_year,1,1)  
				var start_date_ytd_sply = date(start_year-1,1,1)  
				var start_date_qtd = date(start_year,start_qtr_month ,1)  
				var start_date_qtd_sply = date(start_year -1,start_qtr_month,1)  
				var start_date_mtd = date(start_year,start_month,1)  
				var start_date_mtd_sply = date(start_year -1,start_month,1)  
				
				// do the calc   
				var res =   CALCULATE (SELECTEDMEASURE (),cal_end_dates[Date] >= start_date_qtd_sply && cal_end_dates[Date] <= end_date_sply )
				
				return res
				
				
				
				```

		calculationItem YTD = ```
				   
				   
				
				-- get the dates
				var curr_date = CALCULATE(MAX(cal_end_dates[Date])) // get the mgmt current end date
				var end_date = curr_date
				var end_date_sply = date(Year(end_date) -1,Month(end_date),day(end_date)) // get the yoy end date
				var start_year = Year(curr_date) 
				var start_qtr_month = (Quarter(curr_date) * 3) - 2  
				var start_month = Month(curr_date)
				var start_date_ytd = date(start_year,1,1)  
				var start_date_ytd_sply = date(start_year-1,1,1)  
				var start_date_qtd = date(start_year,start_qtr_month ,1)  
				var start_date_qtd_sply = date(start_year -1,start_qtr_month,1)  
				var start_date_mtd = date(start_year,start_month,1)  
				var start_date_mtd_sply = date(start_year -1,start_month,1)  
				
				// do the calc   
				var res =   CALCULATE (SELECTEDMEASURE (),cal_end_dates[Date] >= start_date_ytd && cal_end_dates[Date] <= end_date )
				
				return res
				
				
				
				```

		calculationItem YTD_SPLY = ```
				   
				   
				
				-- get the dates
				var curr_date = CALCULATE(MAX(cal_end_dates[Date])) // get the mgmt current end date
				var end_date = curr_date
				var end_date_sply = date(Year(end_date) -1,Month(end_date),day(end_date)) // get the yoy end date
				var start_year = Year(curr_date) 
				var start_qtr_month = (Quarter(curr_date) * 3) - 2  
				var start_month = Month(curr_date)
				var start_date_ytd = date(start_year,1,1)  
				var start_date_ytd_sply = date(start_year-1,1,1)  
				var start_date_qtd = date(start_year,start_qtr_month ,1)  
				var start_date_qtd_sply = date(start_year -1,start_qtr_month,1)  
				var start_date_mtd = date(start_year,start_month,1)  
				var start_date_mtd_sply = date(start_year -1,start_month,1)  
				
				// do the calc   
				var res =   CALCULATE (SELECTEDMEASURE (),cal_end_dates[Date] >= start_date_ytd_sply && cal_end_dates[Date] <= end_date_sply )
				
				return res
				
				
				
				```

		calculationItem SPLY = ```
				   
				   
				// get the same period last year SPLY
				var sply_start = date(Year(Min(cal_end_dates[Date])) -1, Month(Min(cal_end_dates[Date])), Day(Min(cal_end_dates[Date])))
				var sply_end = date(Year(MAX(cal_end_dates[Date])) -1, Month(MAX(cal_end_dates[Date])), Day(MAX(cal_end_dates[Date])))
				
				
				
				// do the calc   
				var res =   CALCULATE (SELECTEDMEASURE (),cal_end_dates[Date] >= sply_start &&  cal_end_dates[Date] <= sply_end)
				
				return res
				
				
				
				```

		calculationItem CURRENT_YEAR = ```
				   
				   
				// get the same period last year SPLY
				var end_date = MAX(cal_end_dates[Date])
				var start_date = date(year(end_date),1,1)
				
				
				
				// do the calc   
				var res =   CALCULATE (SELECTEDMEASURE (),cal_end_dates[Date] >= start_date &&  cal_end_dates[Date] <= end_date)
				
				return res
				
				
				
				```

		calculationItem LAST_YEAR = ```
				   
				   
				// get the period
				var start_date = date(year(MAX(cal_end_dates[Date]))-1,1,1)
				var end_date = date(year(start_date),12,31)
				
				
				// do the calc   
				var res =   CALCULATE (SELECTEDMEASURE(),cal_end_dates[Date] >= start_date &&  cal_end_dates[Date] <= end_date)
				
				return res
				
				
				
				```

		calculationItem PRIOR_TO_LAST_YEAR = ```
				   
				   
				// get the period
				var start_date = date(year(MAX(cal_end_dates[Date]))-2,1,1)
				var end_date = date(year(start_date),12,31)
				
				
				// do the calc   
				var res =   CALCULATE (SELECTEDMEASURE(),cal_end_dates[Date] >= start_date &&  cal_end_dates[Date] <= end_date)
				
				return res
				
				
				
				```

	/// Purpose: Returns the business metric for this measure.
	/// Logic: Computes the metric from its underlying model references.
	/// Dependencies: See model references.
	/// Context: Evaluated in current filter context unless overridden in DAX.
	/// Output: Whole number
	measure 'meas.fiscal_config_offset' =
			
			VAR _config = 0
			
			RETURN
			_config
		formatString: 0
		lineageTag: db9fb399-627b-4ad0-93db-8a5722a1e45e

	/// Column filt_item.
	column filt_item
		dataType: string
		lineageTag: 5a324d62-f85f-42cf-8e7d-1ea63d7011d2
		summarizeBy: none
		sourceColumn: Name
		sortByColumn: Ordinal

		annotation SummarizationSetBy = Automatic

	/// Column Ordinal.
	column Ordinal
		dataType: int64
		isHidden
		lineageTag: 900c1335-ee0a-452b-a5e2-c1510e9c1433
		summarizeBy: sum
		sourceColumn: Ordinal

		annotation SummarizationSetBy = Automatic

